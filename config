#!/bin/bash
echo "Starting GUI configuration..."

# Initialize the .config file
echo "" > .config

# Main menu with multiple option selection
while true; do
    MAIN_CHOICES=$(whiptail --title "Main Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
        "nginx" "Enable nginx" OFF \
        "pgbench" "Enable pgbench" OFF \
        "stress-ng" "Enable stress-ng" OFF \
        "redis" "Enable redis" OFF \
        "openssl" "Enable openssl" OFF \
        "sysbench" "Enable sysbench" OFF \
	"pennant" "Enable pennant" OFF \
	"memcached" "Enable memcached" OFF \
	"hadoop" "Enable hadoop" OFF \
	"compress-7zip" "Enable compress-7zip" OFF 3>&1 1>&2 2>&3)

    # Process main menu choices
    for choice in $MAIN_CHOICES; do
        case $choice in
            "\"nginx\"")
                echo "CONFIG_NGINX=y" >> .config
                # Submenu for nginx options
                while true; do
                    NGINX_OPTIONS=$(whiptail --title "nginx Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Connections:" "" OFF \
                        "1" "1" OFF \
                        "2" "20" OFF \
                        "3" "100" OFF \
                        "4" "200" OFF \
                        "5" "500" OFF \
                        "6" "1000" OFF \
                        "7" "4000" OFF \
                        "8" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous nginx options
                    sed -i '/CONFIG_NGINX_OPTION/d' .config

                    # Save selected nginx options
                    for option in $NGINX_OPTIONS; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_NGINX_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_NGINX_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_NGINX_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_NGINX_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_NGINX_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_NGINX_OPTION_6=y" >> .config
                                ;;
                            "\"7\"")
                                echo "CONFIG_NGINX_OPTION_7=y" >> .config
                                ;;
                            "\"8\"")
                                echo "CONFIG_NGINX_OPTION_8=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"pgbench\"")
                echo "CONFIG_PGBENCH=y" >> .config
                # Submenu for pgbench
                while true; do
                    PGBENCH_CHOICES=$(whiptail --title "pgbench Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Scaling Factor:" "" OFF \
			"1" "1" OFF \
                        "2" "100" OFF \
                        "3" "1000" OFF \
                        "4" "10000" OFF \
                        "5" "25000 [Intended for very large servers.]" OFF \
                        "6" "Test All Options" OFF \
			"" "" OFF\
			"Clients:" "" OFF \
                        "7" "1" OFF \
                        "8" "50" OFF \
                        "9" "100" OFF \
                        "10" "250" OFF \
                        "11" "500" OFF \
                        "12" "800" OFF \
                        "13" "1000" OFF \
                        "14" "5000" OFF \
                        "15" "Test All Options" OFF \
			"" "" OFF \
			"Mode:" "" OFF \
                        "16" "Read Write" OFF \
                        "17" "Read Only" OFF \
                        "18" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous pgbench choices
                    sed -i '/CONFIG_PGBENCH_OPTION/d' .config

                    # Save selected pgbench choices
                    for option in $PGBENCH_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_PGBENCH_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_PGBENCH_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_PGBENCH_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_PGBENCH_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_PGBENCH_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_PGBENCH_OPTION_6=y" >> .config
                                ;;
                            "\"7\"")
                                echo "CONFIG_PGBENCH_OPTION_7=y" >> .config
                                ;;
                            "\"8\"")
                                echo "CONFIG_PGBENCH_OPTION_8=y" >> .config
                                ;;
                            "\"9\"")
                                echo "CONFIG_PGBENCH_OPTION_9=y" >> .config
                                ;;
                            "\"10\"")
                                echo "CONFIG_PGBENCH_OPTION_10=y" >> .config
                                ;;
                            "\"11\"")
                                echo "CONFIG_PGBENCH_OPTION_11=y" >> .config
                                ;;
                            "\"12\"")
                                echo "CONFIG_PGBENCH_OPTION_12=y" >> .config
                                ;;
                            "\"13\"")
                                echo "CONFIG_PGBENCH_OPTION_13=y" >> .config
                                ;;
                            "\"14\"")
                                echo "CONFIG_PGBENCH_OPTION_14=y" >> .config
                                ;;
                            "\"15\"")
                                echo "CONFIG_PGBENCH_OPTION_15=y" >> .config
                                ;;
                            "\"16\"")
                                echo "CONFIG_PGBENCH_OPTION_16=y" >> .config
                                ;;
                            "\"17\"")
                                echo "CONFIG_PGBENCH_OPTION_17=y" >> .config
                                ;;
                            "\"18\"")
                                echo "CONFIG_PGBENCH_OPTION_18=y" >> .config
                                ;;
                            "\"19\"")
                                echo "CONFIG_PGBENCH_OPTION_19=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"stress-ng\"")
                echo "CONFIG_STRESSNG=y" >> .config
                # Submenu for stress-ng
                while true; do
                    STRESSNG_CHOICES=$(whiptail --title "stress-ng Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Test:" "" OFF \
                        "1" "CPU Stress" OFF \
                        "2" "Crypto" OFF \
                        "3" "Memory Copying" OFF \
                        "4" "Glibc Qsort Data Sorting" OFF \
                        "5" "Glibc C String Functions" OFF \
                        "6" "Vector Math" OFF \
                        "7" "Matrix Math" OFF \
                        "8" "Forking" OFF \
                        "9" "System V Message Passing" OFF \
                        "10" "Semaphores" OFF \
                        "11" "Socket Activity" OFF \
                        "12" "Context Switching" OFF \
                        "13" "Atomic" OFF \
                        "14" "CPU Cache" OFF \
                        "15" "Malloc" OFF \
                        "16" "MEMFD" OFF \
                        "17" "MMAP" OFF \
                        "18" "NUMA" OFF \
                        "19" "x86_64 RdRand" OFF \
                        "20" "SENDFILE" OFF \
                        "21" "IO_uring" OFF \
                        "22" "Futex" OFF \
                        "23" "Mutex" OFF \
                        "24" "Function Call" OFF \
                        "25" "Poll" OFF \
                        "26" "Hash" OFF \
                        "27" "Pthread" OFF \
                        "28" "Zlib" OFF \
                        "29" "Floating Point" OFF \
                        "30" "Fused Multiply-Add" OFF \
                        "31" "Pipe" OFF \
                        "32" "Matrix 3D Math" OFF \
                        "33" "AVL Tree" OFF \
                        "34" "Vector Floating Point" OFF \
                        "35" "Vector Shuffle" OFF \
                        "36" "Wide Vector Math" OFF \
                        "37" "Cloning" OFF \
                        "38" "AVX-512 VNNI" OFF \
                        "39" "Mixed Scheduler" OFF \
                        "40" "Exponential Math" OFF \
                        "41" "Fractal Generator" OFF \
                        "42" "Logarithmic Math" OFF \
                        "43" "Power Math" OFF \
                        "44" "Trigonometric Math" OFF \
                        "45" "Jpeg Compression" OFF \
                        "46" "Bitonic Integer Sort" OFF \
                        "47" "Radix String Sort" OFF \
                        "48" "POSIX Regular Expressions" OFF \
                        "49" "Integer Math" OFF \
                        "50" "Integer Bit Operations" OFF \
                        "51" "Bessel Math Operations" OFF \
                        "52" "Hyperbolic Trigonometric Math" OFF \
                        "53" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous stress-ng choices
                    sed -i '/CONFIG_STRESSNG_OPTION/d' .config

                    # Save selected stress-ng choices
                    for option in $STRESSNG_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_STRESSNG_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_STRESSNG_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_STRESSNG_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_STRESSNG_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_STRESSNG_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_STRESSNG_OPTION_6=y" >> .config
                                ;;
                            "\"7\"")
                                echo "CONFIG_STRESSNG_OPTION_7=y" >> .config
                                ;;
                            "\"8\"")
                                echo "CONFIG_STRESSNG_OPTION_8=y" >> .config
                                ;;
                            "\"9\"")
                                echo "CONFIG_STRESSNG_OPTION_9=y" >> .config
                                ;;
                            "\"10\"")
                                echo "CONFIG_STRESSNG_OPTION_10=y" >> .config
                                ;;
                            "\"11\"")
                                echo "CONFIG_STRESSNG_OPTION_11=y" >> .config
                                ;;
                            "\"12\"")
                                echo "CONFIG_STRESSNG_OPTION_12=y" >> .config
                                ;;
                            "\"13\"")
                                echo "CONFIG_STRESSNG_OPTION_13=y" >> .config
                                ;;
                            "\"14\"")
                                echo "CONFIG_STRESSNG_OPTION_14=y" >> .config
                                ;;
                            "\"15\"")
                                echo "CONFIG_STRESSNG_OPTION_15=y" >> .config
                                ;;
                            "\"16\"")
                                echo "CONFIG_STRESSNG_OPTION_16=y" >> .config
                                ;;
                            "\"17\"")
                                echo "CONFIG_STRESSNG_OPTION_17=y" >> .config
                                ;;
                            "\"18\"")
                                echo "CONFIG_STRESSNG_OPTION_18=y" >> .config
                                ;;
                            "\"19\"")
                                echo "CONFIG_STRESSNG_OPTION_19=y" >> .config
				;;
                            "\"20\"")
                                echo "CONFIG_STRESSNG_OPTION_20=y" >> .config
                                ;;
                            "\"21\"")
                                echo "CONFIG_STRESSNG_OPTION_21=y" >> .config
                                ;;
                            "\"22\"")
                                echo "CONFIG_STRESSNG_OPTION_22=y" >> .config
                                ;;
                            "\"23\"")
                                echo "CONFIG_STRESSNG_OPTION_23=y" >> .config
                                ;;
                            "\"24\"")
                                echo "CONFIG_STRESSNG_OPTION_24=y" >> .config
                                ;;
                            "\"25\"")
                                echo "CONFIG_STRESSNG_OPTION_25=y" >> .config
                                ;;
                            "\"26\"")
                                echo "CONFIG_STRESSNG_OPTION_26=y" >> .config
                                ;;
                            "\"27\"")
                                echo "CONFIG_STRESSNG_OPTION_27=y" >> .config
                                ;;
                            "\"28\"")
                                echo "CONFIG_STRESSNG_OPTION_28=y" >> .config
                                ;;
                            "\"29\"")
                                echo "CONFIG_STRESSNG_OPTION_29=y" >> .config
                                ;;
                            "\"30\"")
                                echo "CONFIG_STRESSNG_OPTION_30=y" >> .config
                                ;;
                            "\"31\"")
                                echo "CONFIG_STRESSNG_OPTION_31=y" >> .config
                                ;;
                            "\"32\"")
                                echo "CONFIG_STRESSNG_OPTION_32=y" >> .config
                                ;;
                            "\"33\"")
                                echo "CONFIG_STRESSNG_OPTION_33=y" >> .config
                                ;;
                            "\"34\"")
                                echo "CONFIG_STRESSNG_OPTION_34=y" >> .config
                                ;;
                            "\"35\"")
                                echo "CONFIG_STRESSNG_OPTION_35=y" >> .config
                                ;;
                            "\"36\"")
                                echo "CONFIG_STRESSNG_OPTION_36=y" >> .config
                                ;;
                            "\"37\"")
                                echo "CONFIG_STRESSNG_OPTION_37=y" >> .config
                                ;;
                            "\"38\"")
                                echo "CONFIG_STRESSNG_OPTION_38=y" >> .config
                                ;;
                            "\"39\"")
                                echo "CONFIG_STRESSNG_OPTION_39=y" >> .config
                                ;;
                            "\"40\"")
                                echo "CONFIG_STRESSNG_OPTION_40=y" >> .config
                                ;;
                            "\"41\"")
                                echo "CONFIG_STRESSNG_OPTION_41=y" >> .config
                                ;;
                            "\"42\"")
                                echo "CONFIG_STRESSNG_OPTION_42=y" >> .config
                                ;;
                            "\"43\"")
                                echo "CONFIG_STRESSNG_OPTION_43=y" >> .config
                                ;;
                            "\"44\"")
                                echo "CONFIG_STRESSNG_OPTION_44=y" >> .config
                                ;;
                            "\"45\"")
                                echo "CONFIG_STRESSNG_OPTION_45=y" >> .config
                                ;;
                            "\"46\"")
                                echo "CONFIG_STRESSNG_OPTION_46=y" >> .config
                                ;;
                            "\"47\"")
                                echo "CONFIG_STRESSNG_OPTION_47=y" >> .config
                                ;;
                            "\"48\"")
                                echo "CONFIG_STRESSNG_OPTION_48=y" >> .config
                                ;;
                            "\"49\"")
                                echo "CONFIG_STRESSNG_OPTION_49=y" >> .config
                                ;;
                            "\"50\"")
                                echo "CONFIG_STRESSNG_OPTION_50=y" >> .config
                                ;;
                            "\"51\"")
                                echo "CONFIG_STRESSNG_OPTION_51=y" >> .config
                                ;;
                            "\"52\"")
                                echo "CONFIG_STRESSNG_OPTION_52=y" >> .config
                                ;;
                            "\"53\"")
                                echo "CONFIG_STRESSNG_OPTION_53=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"redis\"")
                echo "CONFIG_REDIS=y" >> .config
                # Submenu for redis
                while true; do
                    REDIS_CHOICES=$(whiptail --title "redis Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Test:" "" OFF \
                        "1" "SET" OFF \
                        "2" "GET" OFF \
                        "3" "LPUSH" OFF \
                        "4" "LPOP" OFF \
                        "5" "SADD" OFF \
                        "6" "Test All Options" OFF \
                        "" "" OFF\
                        "Parallel Connections:" "" OFF \
                        "7" "50" OFF \
                        "8" "500" OFF \
                        "9" "1000" OFF \
                        "10" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous redis choices
                    sed -i '/CONFIG_REDIS_OPTION/d' .config

                    # Save selected redis choices
                    for option in $REDIS_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_REDIS_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_REDIS_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_REDIS_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_REDIS_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_REDIS_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_REDIS_OPTION_6=y" >> .config
                                ;;
                            "\"7\"")
                                echo "CONFIG_REDIS_OPTION_7=y" >> .config
                                ;;
                            "\"8\"")
                                echo "CONFIG_REDIS_OPTION_8=y" >> .config
                                ;;
                            "\"9\"")
                                echo "CONFIG_REDIS_OPTION_9=y" >> .config
                                ;;
                            "\"10\"")
                                echo "CONFIG_REDIS_OPTION_10=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"openssl\"")
                echo "CONFIG_OPENSSL=y" >> .config
                # Submenu for openssl
                while true; do
                    OPENSSL_CHOICES=$(whiptail --title "openssl Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Algorithm:" "" OFF \
                        "1" "RSA4096" OFF \
                        "2" "SHA256" OFF \
                        "3" "SHA512" OFF \
                        "4" "AES-128-GCM" OFF \
                        "5" "AES-256-GCM" OFF \
                        "6" "ChaCha20" OFF \
                        "7" "ChaCha20-Poly1305" OFF \
                        "8" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous openssl choices
                    sed -i '/CONFIG_OPENSSL_OPTION/d' .config

                    # Save selected openssl choices
                    for option in $OPENSSL_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_OPENSSL_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_OPENSSL_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_OPENSSL_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_OPENSSL_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_OPENSSL_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_OPENSSL_OPTION_6=y" >> .config
                                ;;
                            "\"7\"")
                                echo "CONFIG_OPENSSL_OPTION_7=y" >> .config
                                ;;
                            "\"8\"")
                                echo "CONFIG_OPENSSL_OPTION_8=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"sysbench\"")
                echo "CONFIG_SYSBENCH=y" >> .config
                # Submenu for sysbench
                while true; do
                    SYSBENCH_CHOICES=$(whiptail --title "sysbench Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Test:" "" OFF \
                        "1" "CPU" OFF \
                        "2" "RAM / Memory" OFF \
                        "3" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous sysbench choices
                    sed -i '/CONFIG_SYSBENCH_OPTION/d' .config

                    # Save selected sysbench choices
                    for option in $SYSBENCH_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_SYSBENCH_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_SYSBENCH_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_SYSBENCH_OPTION_3=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"pennant\"")
                echo "CONFIG_PENNANT=y" >> .config
                # Submenu for pennant
                while true; do
                    PENNANT_CHOICES=$(whiptail --title "pennant Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Test:" "" OFF \
                        "1" "leblancbig" OFF \
                        "2" "sedovbig" OFF \
                        "3" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous pennant choices
                    sed -i '/CONFIG_PENNANT_OPTION/d' .config

                    # Save selected pennant choices
                    for option in $PENNANT_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_PENNANT_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_PENNANT_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_PENNANT_OPTION_3=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
            "\"memcached\"")
                echo "CONFIG_MEMCACHED=y" >> .config
                # Submenu for memcached
                while true; do
                    MEMCACHED_CHOICES=$(whiptail --title "memcached Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Set To Get Ratio:" "" OFF \
                        "1" "1:100" OFF \
			"2" "1:10" OFF \
			"3" "1:5" OFF \
			"4" "1:1" OFF \
                        "5" "5:1" OFF \
                        "6" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous memcached choices
                    sed -i '/CONFIG_MEMCACHED_OPTION/d' .config

                    # Save selected memcached choices
                    for option in $MEMCACHED_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_MEMCACHED_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_MEMCACHED_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_MEMCACHED_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_MEMCACHED_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_MEMCACHED_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_MEMCACHED_OPTION_6=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
	    "\"compress-7zip\"")
		    echo "CONFIG_COMPRESS7ZIP=y" >> .config
		    ;;
            "\"hadoop\"")
                echo "CONFIG_HADOOP=y" >> .config
                # Submenu for hadoop
                while true; do
                    HADOOP_CHOICES=$(whiptail --title "hadoop Configuration" --checklist "Choose options (use Space to select/deselect, use Tab to ok/cancel):" 20 50 10 \
                        "Operation:" "" OFF \
                        "1" "Create" OFF \
                        "2" "Open" OFF \
                        "3" "Delete" OFF \
                        "4" "File Status" OFF \
                        "5" "Rename" OFF \
                        "6" "Test All Options" OFF \
                        "" "" OFF\
                        "Threads:" "" OFF \
                        "7" "20" OFF \
                        "8" "50" OFF \
                        "9" "100" OFF \
			"10" "500" OFF \
			"11" "1000" OFF \
			"12" "Test All Options" OFF \
			"Files:" "" OFF \
			"13" "100000" OFF \
			"14" "1000000" OFF \
			"15" "10000000" OFF \
                        "16" "Test All Options" OFF 3>&1 1>&2 2>&3)

                    # Check if the user pressed Cancel
                    if [ $? -ne 0 ]; then
                        break
                    fi

                    # Clear previous hadoop choices
                    sed -i '/CONFIG_HADOOP_OPTION/d' .config

                    # Save selected hadoop choices
                    for option in $HADOOP_CHOICES; do
                        case $option in
                            "\"1\"")
                                echo "CONFIG_HADOOP_OPTION_1=y" >> .config
                                ;;
                            "\"2\"")
                                echo "CONFIG_HADOOP_OPTION_2=y" >> .config
                                ;;
                            "\"3\"")
                                echo "CONFIG_HADOOP_OPTION_3=y" >> .config
                                ;;
                            "\"4\"")
                                echo "CONFIG_HADOOP_OPTION_4=y" >> .config
                                ;;
                            "\"5\"")
                                echo "CONFIG_HADOOP_OPTION_5=y" >> .config
                                ;;
                            "\"6\"")
                                echo "CONFIG_HADOOP_OPTION_6=y" >> .config
                                ;;
                            "\"7\"")
                                echo "CONFIG_HADOOP_OPTION_7=y" >> .config
                                ;;
                            "\"8\"")
                                echo "CONFIG_HADOOP_OPTION_8=y" >> .config
                                ;;
                            "\"9\"")
                                echo "CONFIG_HADOOP_OPTION_9=y" >> .config
                                ;;
                            "\"10\"")
                                echo "CONFIG_HADOOP_OPTION_10=y" >> .config
                                ;;
                            "\"11\"")
                                echo "CONFIG_HADOOP_OPTION_11=y" >> .config
                                ;;
                            "\"12\"")
                                echo "CONFIG_HADOOP_OPTION_12=y" >> .config
                                ;;
                            "\"13\"")
                                echo "CONFIG_HADOOP_OPTION_13=y" >> .config
                                ;;
                            "\"14\"")
                                echo "CONFIG_HADOOP_OPTION_14=y" >> .config
                                ;;
                            "\"15\"")
                                echo "CONFIG_HADOOP_OPTION_15=y" >> .config
                                ;;
                            "\"16\"")
                                echo "CONFIG_HADOOP_OPTION_16=y" >> .config
                                ;;
                        esac
                    done

                    # Ask if the user wants to save, go back, or exit
                    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
                        "1" "Save and Continue" \
                        "2" "Save and Exit" \
                        "3" "Back to Main Menu" \
                        "4" "Exit" 3>&1 1>&2 2>&3)

                    case $SAVE_EXIT in
                        "1")
                            echo "Configuration saved."
                            break
                            ;;
                        "2")
                            echo "Configuration saved."
                            exit 0
                            ;;
                        "3")
                            break
                            ;;
                        "4")
                            exit 0
                            ;;
                    esac
                done
                ;;
        esac
    done

    # Ask if the user wants to save and exit, go back, or cancel
    SAVE_EXIT=$(whiptail --title "Save and Exit" --menu "Choose an option:" 15 50 4 \
        "1" "Save and Continue" \
        "2" "Save and Exit" \
        "3" "Back" \
        "4" "Exit" 3>&1 1>&2 2>&3)

    case $SAVE_EXIT in
        "1")
            echo "Configuration saved."
            ;;
        "2")
            echo "Configuration saved."
            exit 0
            ;;
        "3")
            continue
            ;;
        "4")
            exit 0
            ;;
    esac
done

echo "Configuration complete. .config file created."

